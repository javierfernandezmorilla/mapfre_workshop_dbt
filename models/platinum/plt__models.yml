version: 2

models:
  - name: plt_order_items
    description: "Platinum model built from fct_order_items, adding a business classification (plt_order_size) derived from net_revenue_usd."
    tests:
      - if_then:
          name: null_revenue_implies_unknown_size
          arguments:
            if_condition: "net_revenue_usd is null"
            then_condition: "plt_order_size = 'DESCONOCIDA'"
    columns:
      - name: id_lineitem
        description: "Line item surrogate key."
      - name: id_order
        description: "Order surrogate key."
      - name: id_part
        description: "Part surrogate key."
      - name: id_supplier
        description: "Supplier surrogate key."
      - name: id_ship_mode
        description: "Ship mode surrogate key."
      - name: order_date
        description: "Order date (DATE)."
      - name: quantity_qty
        description: "Ordered quantity."
      - name: net_revenue_usd
        description: "Net revenue (gross - discount + tax)."
      - name: plt_order_size
        description: "Business classification from net_revenue_usd using plt_order_size(): PEQUEÑA (<1000), NORMAL (>=1000), GRANDE (>=5000), DESCONOCIDA (NULL)."
        tests:
          - accepted_values:
              values: ["PEQUEÑA", "NORMAL", "GRANDE", "DESCONOCIDA"]
      - name: staged_at_utc
        description: "Build timestamp (UTC)."
